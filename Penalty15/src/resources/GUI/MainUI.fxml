<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="client.GUI.MainController"
            style="-fx-font-family: 'Segoe UI'; -fx-background-color: #e0f2fe;">

    <!-- TOP HEADER -->
    <top>
        <VBox style="-fx-background-color: #0284c7; 
                     -fx-padding: 15 20; 
                     -fx-spacing: 8;
                     -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.25), 10, 0, 0, 4);">
            
            <HBox spacing="15" style="-fx-alignment: center-left;">
                <Label text="âš½ PENALTY SHOOTOUT" 
                       style="-fx-font-size: 20px; -fx-font-weight: bold; -fx-text-fill: white;
                              -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.3), 3, 0, 0, 1);"/>
                <Separator orientation="VERTICAL" prefHeight="20" 
                          style="-fx-background-color: rgba(255,255,255,0.4);"/>
                <Label fx:id="currentUserLabel" 
                       text="ðŸ‘¤ NgÆ°á»i chÆ¡i" 
                       style="-fx-font-size: 14px; -fx-text-fill: white; -fx-font-weight: bold;"/>
                <Region HBox.hgrow="ALWAYS"/>
                <Button fx:id="logoutButton"
                       text="ÄÄ‚NG XUáº¤T" 
                       onAction="#handleLogout" 
                       prefHeight="36"
                       style="-fx-font-size: 12px; 
                              -fx-padding: 8 20; 
                              -fx-background-color: transparent;
                              -fx-text-fill: #fbbf24;
                              -fx-font-weight: bold;
                              -fx-border-radius: 18;
                              -fx-background-radius: 18;
                              -fx-border-color: #fbbf24;
                              -fx-border-width: 2.5;">
                    <cursor><javafx.scene.Cursor fx:constant="HAND" /></cursor>
                </Button>
            </HBox>
            
            <Label fx:id="statusLabel" 
                   text="ðŸ“¢ Sáºµn sÃ ng" 
                   style="-fx-font-size: 11px; -fx-text-fill: white; -fx-font-style: italic;"/>
        </VBox>
    </top>

    <!-- CENTER TABPANE -->
    <center>
        <TabPane style="-fx-padding: 15; -fx-tab-min-width: 120; -fx-tab-min-height: 40; -fx-background-color: transparent;">
            
            <!-- TAB 1: DANH SÃCH NGÆ¯á»œI CHÆ I -->
            <Tab closable="false">
                <graphic>
                    <HBox spacing="6" style="-fx-alignment: center;">
                        <Label text="ðŸ‘¥" style="-fx-font-size: 14px;"/>
                        <Label text="NGÆ¯á»œI CHÆ I" 
                               style="-fx-font-size: 12px; -fx-font-weight: bold;"/>
                    </HBox>
                </graphic>
                
                <VBox spacing="12" style="-fx-padding: 15; -fx-background-color: white; 
                                          -fx-background-radius: 15; -fx-border-radius: 15;
                                          -fx-border-color: #e2e8f0; -fx-border-width: 2;
                                          -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 12, 0.15, 0, 4);">
                    
                    <!-- Search Bar -->
                    <HBox spacing="8" style="-fx-alignment: center-left; -fx-padding: 10; -fx-background-color: #f8fafc; -fx-border-radius: 12; -fx-background-radius: 12;">
                        <Label text="ðŸ”" style="-fx-font-size: 16px;"/>
                        <TextField fx:id="searchField" 
                                  promptText="TÃ¬m kiáº¿m ngÆ°á»i chÆ¡i..." 
                                  HBox.hgrow="ALWAYS"
                                  style="-fx-background-color: white; 
                                         -fx-text-fill: #1e293b;
                                         -fx-border-color: #0ea5e9; 
                                         -fx-border-width: 2; 
                                         -fx-border-radius: 20; 
                                         -fx-background-radius: 20; 
                                         -fx-padding: 8 16;
                                         -fx-font-size: 12px;"/>
                        <Button text="TÃ¬m" 
                               onAction="#handleSearch" 
                               prefWidth="70"
                               style="-fx-background-color: #0284c7; 
                                      -fx-text-fill: white; 
                                      -fx-font-weight: bold; 
                                      -fx-border-radius: 18; 
                                      -fx-background-radius: 18;
                                      -fx-font-size: 12px;
                                      -fx-padding: 8 16;">
                            <cursor><javafx.scene.Cursor fx:constant="HAND" /></cursor>
                        </Button>
                        <Button text="Online" 
                               onAction="#handleFilterOnline" 
                               prefWidth="80"
                               style="-fx-background-color: #0ea5e9; 
                                      -fx-text-fill: white; 
                                      -fx-font-weight: bold; 
                                      -fx-border-radius: 18; 
                                      -fx-background-radius: 18;
                                      -fx-font-size: 12px;
                                      -fx-padding: 8 16;">
                            <cursor><javafx.scene.Cursor fx:constant="HAND" /></cursor>
                        </Button>
                    </HBox>

                    <!-- Users Table -->
                    <TableView fx:id="usersTable" 
                              style="-fx-font-size: 13px; -fx-background-color: white;"
                              VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn text="ðŸ‘¤ TÃªn NgÆ°á»i ChÆ¡i" fx:id="nameColumn" prefWidth="350" minWidth="250"/>
                            <TableColumn text="â­ Äiá»ƒm" fx:id="pointsColumn" prefWidth="120" minWidth="100"/>
                            <TableColumn text="ðŸ“¡ Tráº¡ng ThÃ¡i" fx:id="statusColumn" prefWidth="150" minWidth="120"/>
                            <TableColumn text="ðŸŽ® HÃ nh Äá»™ng" fx:id="actionColumn" prefWidth="150" minWidth="130"/>
                        </columns>
                        <columnResizePolicy>
                            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                        </columnResizePolicy>
                    </TableView>

                    <!-- Info -->
                    <Label text="ðŸ’¡ Nháº¥n nÃºt 'Má»i' Ä‘á»ƒ gá»­i yÃªu cáº§u Ä‘áº¥u vá»›i ngÆ°á»i chÆ¡i" 
                           style="-fx-font-size: 12px; 
                                  -fx-text-fill: #0ea5e9; 
                                  -fx-font-weight: bold;
                                  -fx-padding: 10;
                                  -fx-background-color: #f0f9ff;
                                  -fx-border-radius: 8;
                                  -fx-background-radius: 8;"/>
                </VBox>
            </Tab>

            <!-- TAB 2: Lá»ŠCH Sá»¬ Äáº¤U -->
            <Tab closable="false">
                <graphic>
                    <HBox spacing="8" style="-fx-alignment: center;">
                        <Label text="ðŸ†" style="-fx-font-size: 16px;"/>
                        <Label text="Lá»ŠCH Sá»¬" 
                               style="-fx-font-size: 13px; -fx-font-weight: bold;"/>
                    </HBox>
                </graphic>
                
                <VBox spacing="15" style="-fx-padding: 20; -fx-background-color: white; 
                                          -fx-background-radius: 15; -fx-border-radius: 15;
                                          -fx-border-color: #e2e8f0; -fx-border-width: 2;
                                          -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 12, 0.15, 0, 4);">
                    
                    <!-- HBox chá»©a 2 báº£ng cáº¡nh nhau -->
                    <HBox spacing="20" VBox.vgrow="ALWAYS">
                        <!-- Matches Section - BÃªn trÃ¡i -->
                        <VBox spacing="10" HBox.hgrow="ALWAYS">
                            <Label text="ðŸ“Š CÃ¡c Tráº­n Äáº¥u" 
                                   style="-fx-font-size: 15px; 
                                          -fx-font-weight: bold; 
                                          -fx-text-fill: #0284c7;"/>
                            <TableView fx:id="matchesTable" 
                                      style="-fx-font-size: 13px; -fx-background-color: white;"
                                      VBox.vgrow="ALWAYS">
                                <columns>
                                    <TableColumn text="#ï¸âƒ£ ID" fx:id="matchIdColumn" prefWidth="80" minWidth="60"/>
                                    <TableColumn text="ðŸ‘¤ Äá»‘i Thá»§" fx:id="opponentColumn" prefWidth="180" minWidth="140"/>
                                    <TableColumn text="ðŸ† Káº¿t Quáº£" fx:id="matchResultColumn" prefWidth="130" minWidth="100"/>
                                    <TableColumn text="ðŸ• Thá»i Gian" fx:id="matchTimeColumn" prefWidth="200" minWidth="160"/>
                                </columns>
                                <columnResizePolicy>
                                    <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                                </columnResizePolicy>
                            </TableView>
                        </VBox>

                        <!-- History Section - BÃªn pháº£i -->
                        <VBox spacing="10" HBox.hgrow="ALWAYS">
                            <Label text="ðŸ” Chi Tiáº¿t LÆ°á»£t SÃºt" 
                                   style="-fx-font-size: 15px; 
                                          -fx-font-weight: bold; 
                                          -fx-text-fill: #0284c7;"/>
                            <TableView fx:id="historyTable" 
                                      style="-fx-font-size: 13px; -fx-background-color: white;"
                                      VBox.vgrow="ALWAYS">
                                <columns>
                                    <TableColumn text="ðŸ”¢ LÆ°á»£t" fx:id="roundColumn" prefWidth="80" minWidth="60"/>
                                    <TableColumn text="âš½ Vai TrÃ²" fx:id="roleColumn" prefWidth="120" minWidth="100"/>
                                    <TableColumn text="ðŸŽ¯ HÆ°á»›ng" fx:id="directionColumn" prefWidth="100" minWidth="80"/>
                                    <TableColumn text="ðŸ“Š Káº¿t Quáº£" fx:id="historyResultColumn" prefWidth="130" minWidth="100"/>
                                    <TableColumn text="ðŸ• Thá»i Gian" fx:id="timeColumn" prefWidth="200" minWidth="160"/>
                                </columns>
                                <columnResizePolicy>
                                    <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                                </columnResizePolicy>
                            </TableView>
                        </VBox>
                    </HBox>
                </VBox>
            </Tab>

            <!-- TAB 3: Báº¢NG Xáº¾P Háº NG -->
            <Tab closable="false">
                <graphic>
                    <HBox spacing="8" style="-fx-alignment: center;">
                        <Label text="ðŸ…" style="-fx-font-size: 16px;"/>
                        <Label text="Xáº¾P Háº NG" 
                               style="-fx-font-size: 13px; -fx-font-weight: bold;"/>
                    </HBox>
                </graphic>
                
                <VBox spacing="20" style="-fx-padding: 30; -fx-alignment: top-center; -fx-background-color: white; 
                                          -fx-background-radius: 15; -fx-border-radius: 15;
                                          -fx-border-color: #e2e8f0; -fx-border-width: 2;
                                          -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 12, 0.15, 0, 4);">
                    
                    <Label text="ðŸŒŸ TOP PLAYERS" 
                           style="-fx-font-size: 19px; 
                                  -fx-font-weight: bold; 
                                  -fx-text-fill: #0284c7;
                                  -fx-alignment: center;"/>
                    
                    <!-- Leaderboard Table -->
                    <TableView fx:id="leaderboardTable" 
                              style="-fx-font-size: 14px; -fx-background-color: white;"
                              VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn fx:id="lbRankColumn" text="ðŸ† Háº¡ng" prefWidth="150" minWidth="120"/>
                            <TableColumn fx:id="lbNameColumn" text="ðŸ‘¤ TÃªn NgÆ°á»i ChÆ¡i" prefWidth="350" minWidth="250"/>
                            <TableColumn fx:id="lbPointsColumn" text="â­ Äiá»ƒm Sá»‘" prefWidth="180" minWidth="140"/>
                        </columns>
                        <columnResizePolicy>
                            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                        </columnResizePolicy>
                    </TableView>
                </VBox>
            </Tab>
        </TabPane>
    </center>

</BorderPane>
